#include "pi.def".

% Tests about simulations (the third one has several solutions)
#assert (weak_sim (nat (s (s zz)) c) (nat (s (s zz)) c)).
#assert (weak_sim (nat (s zz) c)
                  (nu x\ nu y\ par (par (nat zz x) (nat (s zz) y))
                                   (add x y c))).

% Tests about bisimulations
#assert (weak_bisim (nu u\ nu d\ (par (nat zz u)
                                 (par (nat (s zz) d)
                                      (add u d t))))
                    (nat (s zz) t)).

#assert (weak_bisim (nu u\ nu d\ (par (nat (s (s zz)) d)
                                 (par (nat (s (s (s zz))) u)
                                      (add u d t))))
                    (nat (s (s (s (s (s zz))))) t)).

% Similar example, but different evolution of the table, which used to crash.
#assert (weak_bisim (nat (s (s (s (s (s zz))))) t)
                    (nu two\ nu three\
                      (par (nat (s (s zz)) two)
                      (par (nat (s (s (s zz))) three) (add two three t))))).

#assert_not (weak_bisim (nu u\ nu d\ (par (nat (s zz) d)
                                     (par (nat (s zz) u)
                                          (add u d t))))
                       (nat (s zz) t)).
